databaseChangeLog:
  - changeSet:
      id: 1
      author: CarloMicieli
      changes:
        - createTable:
            tableName: users
            columns:
              - column:
                  name: username
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_users
              - column:
                  name: password
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
              - column:
                  name: enabled
                  type: BOOLEAN
                  constraints:
                    nullable: false
                  defaultValueBoolean: true
              - column:
                  name: gravatar_hash
                  type: VARCHAR(32)
              - column:
                  name: email
                  type: VARCHAR(100)
  - changeSet:
      id: 2
      author: CarloMicieli
      changes:
        - createTable:
            tableName: authorities
            columns:
              - column:
                  name: username
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: authority
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
        - addPrimaryKey:
            columnNames: username, authority
            constraintName: PK_authorities
            clustered: true
            tableName: authorities
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: username
            baseTableName: authorities
            constraintName: FK_authorities_users
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: username
            referencedTableName: users
            validate: true
  - changeSet:
      id: 3
      author: CarloMicieli
      changes:
        - createTable:
            tableName: images
            columns:
              - column:
                  name: image_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_images
              - column:
                  name: content_type
                  type: VARCHAR(25)
                  constraints:
                    nullable: false
              - column:
                  name: content
                  type: BYTEA
                  constraints:
                    nullable: false
              - column:
                  name: is_deleted
                  type: BOOLEAN
              - column:
                  name: created
                  type: TIMESTAMP WITHOUT TIME ZONE
                  constraints:
                    nullable: false
  - changeSet:
      id: 4
      author: CarloMicieli
      changes:
        - createTable:
            tableName: brands
            columns:
              - column:
                  name: brand_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_brands
              - column:
                  name: name
                  type: VARCHAR(25)
                  constraints:
                    nullable: false
              - column:
                  name: slug
                  type: VARCHAR(25)
                  constraints:
                    nullable: false
              - column:
                  name: brand_logo_id
                  type: UUID
              - column:
                  name: company_name
                  type: VARCHAR(50)
              - column:
                  name: group_name
                  type: VARCHAR(50)
              - column:
                  name: description
                  type: VARCHAR(1000)
              - column:
                  name: email
                  type: VARCHAR(100)
              - column:
                  name: website_url
                  type: VARCHAR(100)
              - column:
                  name: kind
                  type: VARCHAR(25)
                  constraints:
                    nullable: false
              - column:
                  name: address_line1
                  type: VARCHAR(100)
              - column:
                  name: address_line2
                  type: VARCHAR(100)
              - column:
                  name: address_city
                  type: VARCHAR(50)
              - column:
                  name: address_region
                  type: VARCHAR(50)
              - column:
                  name: address_postal_code
                  type: VARCHAR(10)
              - column:
                  name: address_country
                  type: VARCHAR(2)
              - column:
                  name: created
                  type: TIMESTAMP WITHOUT TIME ZONE
                  constraints:
                    nullable: false
              - column:
                  name: last_modified
                  type: TIMESTAMP WITHOUT TIME ZONE
              - column:
                  name: version
                  type: INTEGER
                  constraints:
                    nullable: false
                  defaultValueNumeric: 1
        - addForeignKeyConstraint:
            baseColumnNames: brand_logo_id
            baseTableName: brands
            constraintName: FK_brands_images
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: image_id
            referencedTableName: images
            validate: true
        - createIndex:
            indexName: Idx_brands_name
            tableName: brands
            columns:
              - column:
                  name: name
            unique: true
        - createIndex:
            indexName: Idx_brands_slug
            tableName: brands
            columns:
              - column:
                  name: slug
            unique: true
  - changeSet:
      id: 5
      author: CarloMicieli
      changes:
        - createTable:
            tableName: railways
            columns:
              - column:
                  name: railway_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_railways
              - column:
                  name: name
                  type: VARCHAR(25)
                  constraints:
                    nullable: false
              - column:
                  name: company_name
                  type: VARCHAR(100)
              - column:
                  name: slug
                  type: VARCHAR(25)
                  constraints:
                    nullable: false
              - column:
                  name: railway_logo_id
                  type: UUID
              - column:
                  name: description
                  type: VARCHAR(1000)
              - column:
                  name: country
                  type: VARCHAR(2)
                  constraints:
                    nullable: false
              - column:
                  name: operating_since
                  type: DATE
              - column:
                  name: operating_until
                  type: DATE
              - column:
                  name: active
                  type: BOOLEAN
              - column:
                  name: gauge_mm
                  type: numeric(19, 5)
              - column:
                  name: gauge_in
                  type: numeric(19, 5)
              - column:
                  name: track_type
                  type: VARCHAR(25)
              - column:
                  name: headquarters
                  type: VARCHAR(100)
              - column:
                  name: total_length_mi
                  type: numeric(19, 5)
              - column:
                  name: total_length_km
                  type: numeric(19, 5)
              - column:
                  name: website_url
                  type: VARCHAR(100)
              - column:
                  name: created
                  type: TIMESTAMP WITHOUT TIME ZONE
                  constraints:
                    nullable: false
              - column:
                  name: last_modified
                  type: TIMESTAMP WITHOUT TIME ZONE
              - column:
                  name: version
                  type: INTEGER
                  constraints:
                    nullable: false
                  defaultValueNumeric: 1
        - addForeignKeyConstraint:
            baseColumnNames: railway_logo_id
            baseTableName: railways
            constraintName: FK_railways_images
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: image_id
            referencedTableName: images
            validate: true
        - createIndex:
            indexName: Idx_railways_name
            tableName: railways
            columns:
              - column:
                  name: name
            unique: true
        - createIndex:
            indexName: Idx_railways_slug
            tableName: railways
            columns:
              - column:
                  name: slug
            unique: true
  - changeSet:
      id: 6
      author: CarloMicieli
      changes:
        - createTable:
            tableName: scales
            columns:
              - column:
                  name: scale_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_scales
              - column:
                  name: name
                  type: VARCHAR(25)
                  constraints:
                    nullable: false
              - column:
                  constraints:
                    nullable: false
                  name: slug
                  type: VARCHAR(25)
              - column:
                  name: ratio
                  type: numeric(19, 5)
                  constraints:
                    nullable: false
              - column:
                  name: gauge_mm
                  type: numeric(19, 5)
              - column:
                  name: gauge_in
                  type: numeric(19, 5)
              - column:
                  name: track_type
                  type: VARCHAR(25)
                  constraints:
                    nullable: false
              - column:
                  name: description
                  type: VARCHAR(1000)
              - column:
                  name: standards
                  type: VARCHAR(100)
              - column:
                  name: weight
                  type: INTEGER
              - column:
                  name: created
                  type: TIMESTAMP WITHOUT TIME ZONE
                  constraints:
                    nullable: false
              - column:
                  name: last_modified
                  type: TIMESTAMP WITHOUT TIME ZONE
              - column:
                  name: version
                  type: INTEGER
                  constraints:
                    nullable: false
                  defaultValueNumeric: 1
        - createIndex:
            indexName: Idx_scales_name
            tableName: scales
            columns:
              - column:
                  name: name
            unique: true
        - createIndex:
            indexName: Idx_scales_slug
            tableName: scales
            columns:
              - column:
                  name: slug
            unique: true
  - changeSet:
      id: 7
      author: CarloMicieli
      changes:
        - createTable:
            tableName: catalog_items
            columns:
              - column:
                  name: catalog_item_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_catalog_items
              - column:
                  name: brand_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: scale_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: item_number
                  type: VARCHAR(10)
                  constraints:
                    nullable: false
              - column:
                  name: slug
                  type: VARCHAR(40)
                  constraints:
                    nullable: false
              - column:
                  name: power_method
                  type: VARCHAR(2)
                  constraints:
                    nullable: false
              - column:
                  name: delivery_date
                  type: VARCHAR(10)
              - column:
                  name: available
                  type: BOOLEAN
              - column:
                  name: description
                  type: VARCHAR(250)
                  constraints:
                    nullable: false
              - column:
                  name: model_description
                  type: VARCHAR(2500)
              - column:
                  name: prototype_description
                  type: VARCHAR(2500)
              - column:
                  name: created
                  type: TIMESTAMP WITHOUT TIME ZONE
                  constraints:
                    nullable: false
              - column:
                  name: last_modified
                  type: TIMESTAMP WITHOUT TIME ZONE
              - column:
                  name: version
                  type: INTEGER
                  constraints:
                    nullable: false
                  defaultValueNumeric: 1
        - addForeignKeyConstraint:
            baseColumnNames: brand_id
            baseTableName: catalog_items
            constraintName: FK_catalog_items_brands
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: brand_id
            referencedTableName: brands
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: scale_id
            baseTableName: catalog_items
            constraintName: FK_catalog_items_scales
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: scale_id
            referencedTableName: scales
            validate: true
        - createIndex:
            indexName: Idx_catalog_items_brand_id_item_number
            tableName: catalog_items
            columns:
              - column:
                  name: item_number
              - column:
                  name: brand_id
            unique: true
        - createIndex:
            indexName: Idx_catalog_items_slug
            tableName: catalog_items
            columns:
              - column:
                  name: slug
            unique: true
  - changeSet:
      id: 8
      author: CarloMicieli
      changes:
        - createTable:
            tableName: rolling_stocks
            columns:
              - column:
                  name: rolling_stock_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_rolling_stocks
              - column:
                  name: catalog_item_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: railway_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: category
                  type: VARCHAR(25)
                  constraints:
                    nullable: false
              - column:
                  name: sub_category
                  type: VARCHAR(50)
              - column:
                  name: epoch
                  type: VARCHAR(10)
                  constraints:
                    nullable: false
              - column:
                  name: min_radius
                  type: numeric(19, 5)
              - column:
                  name: couplers
                  type: VARCHAR(10)
              - column:
                  name: livery
                  type: VARCHAR(50)
              - column:
                  name: length_mm
                  type: numeric(19, 5)
              - column:
                  name: length_in
                  type: numeric(19, 5)
              - column:
                  name: type_name
                  type: VARCHAR(25)
              - column:
                  name: road_number
                  type: VARCHAR(15)
              - column:
                  name: series
                  type: VARCHAR(50)
              - column:
                  name: depot
                  type: VARCHAR(100)
              - column:
                  name: dcc_interface
                  type: VARCHAR(10)
              - column:
                  name: control
                  type: VARCHAR(10)
              - column:
                  name: service_level
                  type: VARCHAR(15)
        - addForeignKeyConstraint:
            baseColumnNames: catalog_item_id
            baseTableName: rolling_stocks
            constraintName: FK_rolling_stocks_catalog_items
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: catalog_item_id
            referencedTableName: catalog_items
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: railway_id
            baseTableName: rolling_stocks
            constraintName: FK_rolling_stocks_railways
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: railway_id
            referencedTableName: railways
            validate: true
  - changeSet:
      id: 9
      author: CarloMicieli
      changes:
        - createTable:
            tableName: catalog_items_images
            columns:
              - column:
                  name: catalog_item_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: image_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: is_default
                  type: BOOLEAN
        - addPrimaryKey:
            constraintName: PK_catalog_items_images
            tableName: catalog_items_images
            columnNames: catalog_item_id, image_id
            clustered: true
            validate:  true
        - addForeignKeyConstraint:
            baseColumnNames: catalog_item_id
            baseTableName: catalog_items_images
            constraintName: FK_catalog_items_images_catalog_items
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: catalog_item_id
            referencedTableName: catalog_items
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: image_id
            baseTableName: catalog_items_images
            constraintName: FK_catalog_items_images_images
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: image_id
            referencedTableName: images
            validate: true
  - changeSet:
      id: 10
      author: CarloMicieli
      changes:
        - createTable:
            tableName: shops
            columns:
              - column:
                  name: shop_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_shops
              - column:
                  name: name
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: slug
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: website_url
                  type: VARCHAR(100)
              - column:
                  name: phone_number
                  type: VARCHAR(50)
              - column:
                  name: email
                  type: VARCHAR(100)
              - column:
                  name: address_line1
                  type: VARCHAR(100)
              - column:
                  name: address_line2
                  type: VARCHAR(100)
              - column:
                  name: address_city
                  type: VARCHAR(50)
              - column:
                  name: address_region
                  type: VARCHAR(50)
              - column:
                  name: address_postal_code
                  type: VARCHAR(10)
              - column:
                  name: address_country
                  type: VARCHAR(2)
              - column:
                  name: created
                  type: TIMESTAMP WITHOUT TIME ZONE
                  constraints:
                    nullable: false
              - column:
                  name: last_modified
                  type: TIMESTAMP WITHOUT TIME ZONE
              - column:
                  name: version
                  type: INTEGER
                  constraints:
                    nullable: false
                  defaultValueNumeric: 1
        - createIndex:
            columns:
              - column:
                  name: slug
            indexName: Idx_shops_slug
            tableName: shops
            unique: true
        - createIndex:
            columns:
              - column:
                  name: name
            indexName: Idx_shops_name
            tableName: shops
            unique: true
  - changeSet:
      id: 11
      author: CarloMicieli
      changes:
        - createTable:
            tableName: favourite_shops
            columns:
              - column:
                  name: shop_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: owner
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
        - addPrimaryKey:
            constraintName: PK_favourite_shops
            tableName: favourite_shops
            columnNames: shop_id, owner
            clustered: true
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: shop_id
            baseTableName: favourite_shops
            constraintName: FK_favourite_shops_shop_id
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: shop_id
            referencedTableName: shops
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: owner
            baseTableName: favourite_shops
            constraintName: FK_favourite_shops_users
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: username
            referencedTableName: users
            validate: true
  - changeSet:
      id: 12
      author: CarloMicieli
      changes:
        - createTable:
            tableName: collections
            columns:
              - column:
                  name: collection_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_collections
              - column:
                  name: owner
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: notes
                  type: VARCHAR(250)
              - column:
                  name: created
                  type: TIMESTAMP WITHOUT TIME ZONE
                  constraints:
                    nullable: false
              - column:
                  name: last_modified
                  type: TIMESTAMP WITHOUT TIME ZONE
              - column:
                  name: version
                  type: INTEGER
                  constraints:
                    nullable: false
                  defaultValueNumeric: 1
        - addForeignKeyConstraint:
            baseColumnNames: owner
            baseTableName: collections
            constraintName: FK_collections_users
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: username
            referencedTableName: users
            validate: true
        - createIndex:
            indexName: Idx_collections_owner
            tableName: collections
            columns:
              - column:
                  name: owner
  - changeSet:
      id: 13
      author: CarloMicieli
      changes:
        - createTable:
            tableName: collection_items
            columns:
              - column:
                  name: collection_item_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_collection_items
              - column:
                  name: collection_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: catalog_item_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: condition
                  type: VARCHAR(15)
                  constraints:
                    nullable: false
              - column:
                  name: price
                  type: numeric(19, 5)
                  constraints:
                    nullable: false
              - column:
                  name: currency
                  type: VARCHAR(3)
                  constraints:
                    nullable: false
              - column:
                  name: shop_id
                  type: UUID
              - column:
                  name: purchased_date
                  type: DATE
              - column:
                  name: added_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: removed_date
                  type: DATE
              - column:
                  name: notes
                  type: VARCHAR(150)
        - addForeignKeyConstraint:
            baseColumnNames: collection_id
            baseTableName: collection_items
            constraintName: FK_collection_items_collections
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: collection_id
            referencedTableName: collections
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: catalog_item_id
            baseTableName: collection_items
            constraintName: FK_collection_items_catalog_items
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: catalog_item_id
            referencedTableName: catalog_items
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: shop_id
            baseTableName: collection_items
            constraintName: FK_collection_items_shops
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: shop_id
            referencedTableName: shops
            validate: true
  - changeSet:
      id: 14
      author: CarloMicieli
      changes:
        - createTable:
            tableName: wishlists
            columns:
              - column:
                  name: wishlist_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_wishlists
              - column:
                  name: owner
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: slug
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
              - column:
                  name: wishlist_name
                  type: VARCHAR(100)
              - column:
                  name: visibility
                  type: VARCHAR(15)
                  constraints:
                    nullable: false
              - column:
                  name: budget
                  type: numeric(19, 5)
              - column:
                  name: currency
                  type: VARCHAR(3)
              - column:
                  name: created
                  type: TIMESTAMP WITHOUT TIME ZONE
                  constraints:
                    nullable: false
              - column:
                  name: last_modified
                  type: TIMESTAMP WITHOUT TIME ZONE
              - column:
                  name: version
                  type: INTEGER
                  constraints:
                    nullable: false
                  defaultValueNumeric: 1
        - addForeignKeyConstraint:
            baseColumnNames: owner
            baseTableName: wishlists
            constraintName: FK_wishlists_users
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: username
            referencedTableName: users
            validate: true
        - createIndex:
            indexName: Idx_wishlists_slug
            tableName: wishlists
            columns:
              - column:
                  name: slug
  - changeSet:
      id: 15
      author: CarloMicieli
      changes:
        - createTable:
            tableName: wishlist_items
            columns:
              - column:
                  name: wishlist_item_id
                  type: UUID
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: PK_wishlist_items
              - column:
                  name: wishlist_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: catalog_item_id
                  type: UUID
                  constraints:
                    nullable: false
              - column:
                  name: priority
                  type: VARCHAR(10)
                  constraints:
                    nullable: false
              - column:
                  name: added_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: removed_date
                  type: DATE
              - column:
                  name: price
                  type: numeric(19, 5)
              - column:
                  name: currency
                  type: VARCHAR(3)
              - column:
                  name: notes
                  type: VARCHAR(150)
        - addForeignKeyConstraint:
            baseColumnNames: wishlist_id
            baseTableName: wishlist_items
            constraintName: FK_wishlist_items_wishlists
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: wishlist_id
            referencedTableName: wishlists
            validate: true
        - addForeignKeyConstraint:
            baseColumnNames: catalog_item_id
            baseTableName: wishlist_items
            constraintName: FK_wishlist_items_catalog_items
            deferrable: false
            initiallyDeferred: false
            onDelete: NO ACTION
            onUpdate: NO ACTION
            referencedColumnNames: catalog_item_id
            referencedTableName: catalog_items
            validate: true
